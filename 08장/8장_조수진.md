# 8장. 테이블 설계의 기초 - 테이블의 개념과 정규형

테이블은 공통 요소들의 집합이며, 함수이다.(X를 입력하면 Y를 출력하는 대응표)

### 테이블 설계의 기초

관계형 데이터베이스에서 데이터는 테이블에 저장된다. 대규모의 복잡한 데이터를 모순없이 장기적으로 관리하기 위해 테이블 설계가 중요하다.

테이블은 `어떤 공통 속성을 가진 집합(개념)` 이며, 표의 형식을 가진다.

→ 테이블 명은 반드시 복수형이나 집합명사로 표현해야 한다.

시스템에서 하드웨어어와 관련있는가로 구분지어,
아키텍처 설계 = 물리 설계
테이블 설계 = 논리 설계

### 테이블 설계 규칙

1. 사물과 사물의 집합은 계층이 다르다
    
    예시) 완두콩 테이블, 토마토 테이블, 옥수수 테이블 X → 채소 테이블
    
    예시) 토마토 테이블(O) → 토마토A, 토마토B, 토마C..
    
2. 가장 상위의 개념 집합으로 정리한다
    
    : 문맥에 따라 규정하는 집합이 달라질 수 있다
    
    예시) 회원 테이블(O), 일반 회원 & 프리미엄 회원 테이블(O), 남성 회원 & 여성 회원 테이블(O)..
    
    → 가장 상위의 회원을 테이블로 만들고, 일반&프리미엄 회원, 성별은 열로 구별한다
    
    → 이렇게 했을 때, 애플리케이션의 유연성이 높아진다
    
3. 열이란 개체의 속성이다
    
    RDB를 자바에 맵핑하면 테이블은 클래스, 행은 인스턴스, 열은 속성에 해당
    
4. 현실 세계에 같은 사람은 2명 있지 않다
    
    → 한 개의 테이블의 내용에는 중복 행이 있다면 실제 두 데이터의 구분이 지 않는다 → 허용하지 않는다
    
5. 기본키 할당은 관리의 기본
    
    → 데이터를 고유하게 식별할 수 있는 기본키를 반드시 할당하라(ex. 회원 ID, 건강보험증 번호 등)
    
6. 기본키는 중복되면 안된다
7. 기본키의 값이 바뀌면 왜 곤란한가
    - 변경 후 값의 유일성을 보증할 수 없다
    - 과거 데이터와의 결합(매칭)이 어렵다
8. 기본키 열로 Null 불가

### 정규형

정규형 = 제대로 된 형태 = 데이터의 갱신이 발생한 경우에도 부정합이 발생하기 어려운 테이블의 형태

제1-5정규형이 있지만 실무에서는 정합성을 유지하기 위해 주로 `제2,3정규형`을 이해하는 것이 중요!

**함수 종속성(Functional Dependency)**

테이블은 Y = F(X)의 관계를 맺는 입력값과 출력값의 대응표이다

→ 기본키 열(X)와 일반키 열(Y) 사이에 성립하는 함수적인 유일성을 함수 종속성. 중괄호로 표현.

`{사원 ID} → {이름, 나이}`

**제1정규형(1NF)**

테이블 셀에 복합적인 값(배열, 복수의 값)을 포함하지 않는다

= 스칼라 값(단일값, 더 이상 나눠지지 않는 값) 이외의 값을 포함하지 않는다

- 복합키를 허용하면 기본키가 행의 값(일반키의 열)을 고유하게 특정할 수 없기 때문

**제2정규형(2NF)**

부분 함수 종속성(기본키를 구성하는 열의 일부에만 함수 종속이 존재하는 것)을 가지지 않는다

→ 기본키: {주문번호 + 상품코드} But {상품코드} → {상품명}

⇒ 집합을 더 명확하게 분리시킨다

![Untitled](https://lxxjn0-dev.netlify.app/static/8a27ce35b98f16356d07f35214c5d397/7d769/regular-3.png)

- 제2정규화가 되지 않으면,
    - 테이블의 부분 정보를 알지 못하면 데이터를 등록하기 어렵다
    - 부분 함수 종속에 해당하는 부분이 중복되며, 일부가 잘못 등록될 수 있다 = 데이터 부정합 = 갱신 이상

**제3정규형(3NF)**

추이함수 종속(기본키 이외의 키 간에 발생하는 함수 종속)을 가지지 않는다

⇒ 추이 함수 종속이 생기는 부분을 테이블 분리(집합을 명확히 분리)

![Untitled](https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F9974AB4E5BD9AB0A1E)

- 제3정규화가 되지 않으면, 아직 관계가 생기지 않은 데이터를 등록(ex. 기계공학과)할 방법이 없다

### ER 다이어그램

테이블의 수가 많아지면 테이블 간의 관계성을 파악하기 어렵다. 이런 테이블 간의 관련선을 한눈에 알 수 있게 그래픽으로 표현하는 기술이 ER 다이어그램

![Untitled](https://blog.kakaocdn.net/dn/4AmaB/btqEP3qzzcU/TLPnBeceKcKJ2g7Ylib5Dk/img.png)

- 엔티티는 사각형으로 표현
    - 엔티티 윗 부분은 기본키
    - 엔티티 아래 기타 열 표기
    - FK는 외래키
- 외래키에 의한 엔티티간의 관계(릴레이션십)은 기호로 표현
    - 점선: 참조하는 엔티티는 참조되는 엔티티(부모 개체)의 존재여부와 관계없이 존재할 수 있음
    - 직선: 참조하는 엔티티는 참조되는 엔티티(부모 개체)가 존재해야 존재할 수 있음
        
        → 부모 개체의 키가 주식별자인 경우
        
    - O: 0
    - -: 1
    - 새다리 모양: 2이상(복수)
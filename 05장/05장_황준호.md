## 5장. DBMS를 조작할 때 필요한 기본지식 - 조작하기 전에 알아두어야 할 것

### 데이터베이스에 전화 걸기

- 커넥션
  - 전화와 유사하다
  - 커넥션이 유지되는 동안에는 사용자와 데이터베이스는 정보를 주고 받을 수 있다
  - MySQL은 동시에 여러개의 커넥션을 유지하는 것이 가능하기 때문에 id로 관리한다
    - 로그인 하면 `Your MySQL connection id is 11` 같은 메시지를 볼 수 있다.
  - `show status like 'Threads_connected';` : 커넥션의 상태나 수를 조사하기 위한 명령어
  - `quit` : 로그오프 (커넥션 끊기) 명령어
- 세션?
  - 커넥션의 시작과 종료 사이의 교환의 시작과 종료까지의 단위
  - 커넥션이 확립된 후에 세션이 만들어짐
  - 기본적으로 커넥션과 세션은 1:1로 대응됨. 
    - 커넥션이 성립되면 동시에 암묵적으로 세션도 시작되고 세션을 끊으면 커넥션도 끊어지는 경우가 많음

### SQL과 관리 명령의 차이

- 관리명령
  - (필자가 지어낸 용어)
  - SQL 외에 데이터베이스의 상태를 보기 위한 명령
  - DBMS가 정상적으로 동작하는지 감시하거나 이상한 동작을 할 때 문제해결을 위해 정보수집을 하는 용도
  - 예:
    - `show status like 'Uptime';` : MySQL이 가동된 시점부터의 경과시간(초)
    - `show status like 'Queries';` : MySQL이 실행한 SQL문의 수

### 관계형 데이터베이스의 계층

- 계층 구조 (4계층)

  ```
  인스턴스 ┬ 데이터베이스1 ┬ 스키마1 ┬ 테이블1
         │           │        ├ 테이블2
         │           │        └ 테이블3
         │           └ 스키마2 ┬ 테이블4
         │                   └ 테이블5
         └ 테이터베이스2 ─ 스키마3 ─ 테이블6                    
  ```

  - 스키마
    - schema는 '틀'이라는 의미
    - 데이터베이스에서 폴더에 해당
    - 권한 관리를 수행할 수 있음
  - 데이터베이스
    - 스키마 상위의 계층
  - 인스턴스
    - 데이터베이스 상위의 계층
    - 물리적 개념으로, DBMS가 동작할때의 단위 (OS입장에선 프로세스라고 불림)
    - DBMS에 따라서는 인스턴스를 '서버 프로세스'또는 '서버'로 부르는 경우도 있음

- DB마다 계층구조가 다름

  - 3계층 : MySQL, Oracle

  - 4계층 : SQL Server, DB2, PostgreSQL

  - MySQL의 계층구조

    ```
    인스턴스 ┬ 스키마1 ┬ 테이블1
           │       ├ 테이블2
           │       └ 테이블3
           ├ 스키마2 ┬ 테이블4
           │       └ 테이블5
           └ 스키마3 ─ 테이블6      
    ```

    - 데이터베이스와 스키마를 동일한 것으로 간주함

  - Oracle의 계층구조

    ```
    인스턴스 ─ 데이터베이스1 ┬ 스키마1 ┬ 테이블1
                        │       ├ 테이블2
                        │       └ 테이블3
                        ├ 스키마2 ┬ 테이블4
                        │       └ 테이블5
                        └ 스키마3 ─ 테이블6 
    ```

    - 인스턴스 아래에 데이터베이스를 한 개만 만들 수 있음

- 4계층이 ANSI가 정한 표준 SQL로 결정되어 있음
